(function(e){function t(t){for(var a,i,o=t[0],c=t[1],l=t[2],u=0,g=[];u<o.length;u++)i=o[u],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&g.push(s[i][0]),s[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);d&&d(t);while(g.length)g.shift()();return n.push.apply(n,l||[]),r()}function r(){for(var e,t=0;t<n.length;t++){for(var r=n[t],a=!0,o=1;o<r.length;o++){var c=r[o];0!==s[c]&&(a=!1)}a&&(n.splice(t--,1),e=i(i.s=r[0]))}return e}var a={},s={app:0},n=[];function i(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=a,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(r,a,function(t){return e[t]}.bind(null,a));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var d=c;n.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"0300":function(e,t,r){},"034f":function(e,t,r){"use strict";var a=r("85ec"),s=r.n(a);s.a},1:function(e,t){},"1d53":function(e,t,r){"use strict";var a=r("91ce"),s=r.n(a);s.a},2:function(e,t){},2833:function(e){e.exports=JSON.parse('{"GRID_PROVIDER":{"default":{"PROVIDER_ADDR":"https://cors-anywhere.herokuapp.com/https://rcijeux.fr/drupal_game/notretemps","PROVIDER_EXTENSION":".mfj","GRIDS":{"themed":{"root":"/mflechest/grids/mflechest_","ranges":{"0":[125,385]}},"giantthemed":{"root":"/mflechesgt/grids/mflechesgt_","ranges":{"0":[27,77]}},"giant":{"root":"/mflechesg/grids/mflechesg_","ranges":{"1":[1,170],"2":[1,170],"3":[1,112],"4":[1,57]}},"regular":{"root":"/mfleches/grids/mfleches_","ranges":{"1":[250,1934],"2":[250,1934],"3":[250,1934],"4":[250,1934]}}}},"custom":{"PROVIDER_ADDR":"./custom","PROVIDER_EXTENSION":".mfj","GRIDS":{"regular":{"root":"/","ranges":{"0":[0,0]}}}}}}')},5541:function(e,t,r){r("ac1f"),r("5319"),r("1276");var a=r("3022"),s=r("b00c");function n(){this.pos=null,this.value=null,this.dotted=0,this.theme=!1,this.type=null}function i(e,t){this.pos=e,this.value=t,this.color="#000000",this.player="",this.type=s.CaseType.Letter,this.available=!0}function o(e,t){this.pos=e,this.value=t,this.type=s.CaseType.Description,this.themed=0,this.nbDesc=t>"d"?2:1,this.desc=[],this.arrow=[],this.desc[0]=null,this.arrow[0]=null,this.nbLines=this.nbDesc,2==this.nbDesc&&(this.desc[1]=null,this.arrow[1]=null)}function c(e,t){this.pos=e,this.type=s.CaseType.Empty}n.prototype.setThemeCase=function(e){this.theme=e},n.prototype.setDotted=function(e){this.dotted=e},a.inherits(i,n),a.inherits(o,n),a.inherits(c,n),o.prototype.setDescription=function(e){var t;return null==this.desc[0]?(t=e.replace(/\n/gi,"<br/>"),"%"===t.charAt(0)&&(this.themed|=1,t=t.substr(1)),this.nbLines+=e.split("\n").length-1,this.desc[0]=t,!0):2==this.nbDesc&&null==this.desc[1]&&(t=e.replace(/\n/gi,"<br/>"),"%"===t.charAt(0)&&(this.themed|=2,t=t.substr(1)),this.nbLines+=e.split("\n").length-1,this.desc[1]=t,!0)},e.exports.EmptyCase=c,e.exports.LetterCase=i,e.exports.DescriptionCase=o},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("div",{staticClass:"playground"},[r("grid",{key:"grid-"+e.gridKey,ref:"grid",attrs:{grid_id:e.gridKey,player:e.channel},on:{wordfound:e.updateScore}}),r("div",{staticClass:"score"},[r("ul",{attrs:{id:"scoreList"}},e._l(e.getScoreList,(function(t){return r("li",{key:"score-"+t[0],style:"color: "+(e.scoreboard[t[0]].color?e.scoreboard[t[0]].color:"#FFFFFF")},[e._v(" "+e._s(t[0])+" "),r("small",[e._v("("+e._s(e.scoreboard[t[0]].score)+")")])])})),0),e.channel?r("iframe",{attrs:{frameborder:"0",id:"tchat",scrolling:"true",src:"https://www.twitch.tv/embed/"+e.channel+"/chat?parent="+e.getDomain+"&darkpopout",height:"60%",width:"100%"}}):e._e()])],1),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.channel,expression:"!channel"}],staticClass:"modal"},[r("div",{staticClass:"inner"},[r("p",[e._v("Pour pouvoir jouer, il vous faut tout d'abord prÃ©ciser le nom de la chaÃ®ne Twitch dont le chat sera utilisÃ© pour lire les rÃ©ponses des spectateurs.")]),r("p",[e._v("Quelle est le nom de la chaÃ®ne Twitch que vous souhaitez utiliser ?")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.inputChannel,expression:"inputChannel"}],attrs:{type:"text"},domProps:{value:e.inputChannel},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loadChannel(t)},input:function(t){t.target.composing||(e.inputChannel=t.target.value)}}})])])])},n=[],i=(r("99af"),r("c975"),r("d81d"),r("b64b"),r("d3b7"),r("ac1f"),r("25f0"),r("3ca3"),r("466d"),r("841c"),r("498a"),r("ddb0"),r("2b3d"),r("2833")),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"playarea",staticClass:"playarea"},[r("div",{staticClass:"gameInfo"},[r("strong",{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}],staticClass:"error"},[e._v(e._s(e.error))]),r("span",[e._v("Temps Ã©coulÃ© "),r("strong",[e._v(e._s(e.elapsed))])]),r("span",[e._v("Lettres restantes "),r("strong",[e._v(e._s(e.nbLetters))])]),r("button",{on:{click:e.resetZoom}},[e._v("ðŸ”Ž")]),r("span",[e._v("Force "),r("strong",[e._v(e._s(e.metadata.force))])]),r("span",{directives:[{name:"show",rawName:"v-show",value:e.metadata.isThemed,expression:"metadata.isThemed"}]},[e._v("ThÃ¨me : "),r("strong",[e._v(e._s(e.metadata.theme))])])]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"loading"},[r("svg",{staticStyle:{margin:"auto",background:"#fff",display:"block"},attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"200px",height:"200px",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid"}},[r("g",{attrs:{transform:"translate(80,50)"}},[r("g",{attrs:{transform:"rotate(0)"}},[r("circle",{attrs:{cx:"0",cy:"0",r:"6",fill:"#fecaca","fill-opacity":"1"}},[r("animateTransform",{attrs:{attributeName:"transform",type:"scale",begin:"-0.875s",values:"1.5 1.5;1 1",keyTimes:"0;1",dur:"1s",repeatCount:"indefinite"}}),r("animate",{attrs:{attributeName:"fill-opacity",keyTimes:"0;1",dur:"1s",repeatCount:"indefinite",values:"1;0",begin:"-0.875s"}})],1)])]),r("g",{attrs:{transform:"translate(71.21320343559643,71.21320343559643)"}},[r("g",{attrs:{transform:"rotate(45)"}},[r("circle",{attrs:{cx:"0",cy:"0",r:"6",fill:"#fecaca","fill-opacity":"0.875"}},[r("animateTransform",{attrs:{attributeName:"transform",type:"scale",begin:"-0.75s",values:"1.5 1.5;1 1",keyTimes:"0;1",dur:"1s",repeatCount:"indefinite"}}),r("animate",{attrs:{attributeName:"fill-opacity",keyTimes:"0;1",dur:"1s",repeatCount:"indefinite",values:"1;0",begin:"-0.75s"}})],1)])]),r("g",{attrs:{transform:"translate(50,80)"}},[r("g",{attrs:{transform:"rotate(90)"}},[r("circle",{attrs:{cx:"0",cy:"0",r:"6",fill:"#fecaca","fill-opacity":"0.75"}},[r("animateTransform",{attrs:{attributeName:"transform",type:"scale",begin:"-0.625s",values:"1.5 1.5;1 1",keyTimes:"0;1",dur:"1s",repeatCount:"indefinite"}}),r("animate",{attrs:{attributeName:"fill-opacity",keyTimes:"0;1",dur:"1s",repeatCount:"indefinite",values:"1;0",begin:"-0.625s"}})],1)])]),r("g",{attrs:{transform:"translate(28.786796564403577,71.21320343559643)"}},[r("g",{attrs:{transform:"rotate(135)"}},[r("circle",{attrs:{cx:"0",cy:"0",r:"6",fill:"#fecaca","fill-opacity":"0.625"}},[r("animateTransform",{attrs:{attributeName:"transform",type:"scale",begin:"-0.5s",values:"1.5 1.5;1 1",keyTimes:"0;1",dur:"1s",repeatCount:"indefinite"}}),r("animate",{attrs:{attributeName:"fill-opacity",keyTimes:"0;1",dur:"1s",repeatCount:"indefinite",values:"1;0",begin:"-0.5s"}})],1)])]),r("g",{attrs:{transform:"translate(20,50.00000000000001)"}},[r("g",{attrs:{transform:"rotate(180)"}},[r("circle",{attrs:{cx:"0",cy:"0",r:"6",fill:"#fecaca","fill-opacity":"0.5"}},[r("animateTransform",{attrs:{attributeName:"transform",type:"scale",begin:"-0.375s",values:"1.5 1.5;1 1",keyTimes:"0;1",dur:"1s",repeatCount:"indefinite"}}),r("animate",{attrs:{attributeName:"fill-opacity",keyTimes:"0;1",dur:"1s",repeatCount:"indefinite",values:"1;0",begin:"-0.375s"}})],1)])]),r("g",{attrs:{transform:"translate(28.78679656440357,28.786796564403577)"}},[r("g",{attrs:{transform:"rotate(225)"}},[r("circle",{attrs:{cx:"0",cy:"0",r:"6",fill:"#fecaca","fill-opacity":"0.375"}},[r("animateTransform",{attrs:{attributeName:"transform",type:"scale",begin:"-0.25s",values:"1.5 1.5;1 1",keyTimes:"0;1",dur:"1s",repeatCount:"indefinite"}}),r("animate",{attrs:{attributeName:"fill-opacity",keyTimes:"0;1",dur:"1s",repeatCount:"indefinite",values:"1;0",begin:"-0.25s"}})],1)])]),r("g",{attrs:{transform:"translate(49.99999999999999,20)"}},[r("g",{attrs:{transform:"rotate(270)"}},[r("circle",{attrs:{cx:"0",cy:"0",r:"6",fill:"#fecaca","fill-opacity":"0.25"}},[r("animateTransform",{attrs:{attributeName:"transform",type:"scale",begin:"-0.125s",values:"1.5 1.5;1 1",keyTimes:"0;1",dur:"1s",repeatCount:"indefinite"}}),r("animate",{attrs:{attributeName:"fill-opacity",keyTimes:"0;1",dur:"1s",repeatCount:"indefinite",values:"1;0",begin:"-0.125s"}})],1)])]),r("g",{attrs:{transform:"translate(71.21320343559643,28.78679656440357)"}},[r("g",{attrs:{transform:"rotate(315)"}},[r("circle",{attrs:{cx:"0",cy:"0",r:"6",fill:"#fecaca","fill-opacity":"0.125"}},[r("animateTransform",{attrs:{attributeName:"transform",type:"scale",begin:"0s",values:"1.5 1.5;1 1",keyTimes:"0;1",dur:"1s",repeatCount:"indefinite"}}),r("animate",{attrs:{attributeName:"fill-opacity",keyTimes:"0;1",dur:"1s",repeatCount:"indefinite",values:"1;0",begin:"0s"}})],1)])])])]),e.grid?r("div",{style:e.getGridStyle,attrs:{id:"grille"}},[e._l(e.grid.cases,(function(t){return[2===t.type?r("case-letter",{key:"case-"+t.pos,attrs:{value:t}}):e._e(),3===t.type?r("case-description",{key:"case-"+t.pos,attrs:{value:t,grid:e.grid},on:{guess:e.promptGuess}}):e._e(),4===t.type?r("case-empty",{key:"case-"+t.pos}):e._e()]}))],2):e._e(),r("div",{directives:[{name:"show",rawName:"v-show",value:e.guess.show,expression:"guess.show"}],staticClass:"modal guess",on:{click:function(t){e.guess.show=!1}}},[r("div",{staticClass:"inner",on:{click:function(e){e.stopPropagation()}}},[r("p",[e._v(e._s(e.guess.prompt))]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.guess.input,expression:"guess.input"}],ref:"guessInput",attrs:{type:"text"},domProps:{value:e.guess.input},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.tryGuess(t)},input:function(t){t.target.composing||e.$set(e.guess,"input",t.target.value)}}})])])])},c=[],l=(r("4160"),r("fb6a"),r("159b"),r("7d05")),d=r.n(l),u=(r("4d63"),r("5319"),{slugify:function(e){e=e.replace(/^\s+|\s+$/g,""),e=e.toLowerCase();for(var t="Ã Ã¡Ã¤Ã¢Ã¨Ã©Ã«ÃªÃ¬Ã­Ã¯Ã®Ã²Ã³Ã¶Ã´Ã¹ÃºÃ¼Ã»Ã±Ã§Â·/_,:;",r="aaaaeeeeiiiioooouuuunc------",a=0,s=t.length;a<s;a++)e=e.replace(new RegExp(t.charAt(a),"g"),r.charAt(a));return e=e.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),e}}),g=r("65ab"),p=r.n(g),m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"case description"},[e._l(e.value.arrow,(function(t){return r("div",{key:e.value.pos+"-"+t,class:"arrow arrow-"+t},[r("span",{staticClass:"cellId"},[e._v(e._s(e.getIdx(e.value.pos,t)))])])})),r("div",{staticClass:"def"},e._l(e.value.desc,(function(t,a){return r("span",{key:e.value.pos+"-def-"+a,class:"defsize-"+e.value.nbLines+" "+(e.value.themed&a+1?"themed":""),domProps:{innerHTML:e._s(t)},on:{click:function(t){return e.triggerGuess(a)}}})})),0)],2)},f=[],h={name:"DescriptionCase",props:["value","grid"],components:{},data:function(){return{}},created:function(){},mounted:function(){},computed:{},methods:{triggerGuess:function(e){var t=this.value.desc[e].replaceAll("â€“<br/>","").replaceAll("â€“","").replaceAll("<br/>"," ");this.$emit("guess",{def:t,idx:this.getIdx(this.value.pos,this.value.arrow[e])})},getIdx:function(e,t){return 0===t||1===t||4===t?e+1:2===t||3===t?e+this.grid.nbColumns:0}}},v=h,b=(r("1d53"),r("2877")),y=Object(b["a"])(v,m,f,!1,null,null,null),_=y.exports,w=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"case empty"})},C=[],R={name:"EmptyCase",components:{},data:function(){return{}},created:function(){},mounted:function(){},computed:{},methods:{}},k=R,x=(r("bbd7"),Object(b["a"])(k,w,C,!1,null,null,null)),G=x.exports,I=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"case letter",class:[e.value.dashed?"dash-"+e.value.dashed:"",e.value.available?"":"found"],style:"color: "+(e.value.color?e.value.color:"#000000"),attrs:{title:e.value.player}},[e._v(" "+e._s(e.value.available?"":e.value.value)+" ")])},T=[],D={name:"LetterCase",props:["value"],components:{},data:function(){return{}},created:function(){},mounted:function(){},computed:{},methods:{}},S=D,A=(r("dd71"),Object(b["a"])(S,I,T,!1,null,null,null)),L=A.exports,N={name:"grid",props:["grid_id","player"],components:{CaseDescription:_,CaseEmpty:G,CaseLetter:L},data:function(){return{loading:!0,error:"",guess:{show:!1,input:"",position:0,prompt:""},gm:null,grid:null,remaining:0,nbLetters:0,elapsedRaw:0,startedAt:null,panzoom:null,metadata:{force:0,isThemed:!1,isGiant:!1,theme:"",provider:"",gridId:0}}},created:function(){var e=this;this.grid_id&&(this.gm=new p.a,this.gm.retreiveAndParseGrid(this.grid_id,(function(t){if(null==t)e.error="La grille n'a pas pu Ãªtre rÃ©cupÃ©rÃ©e",console.error("[ERROR] Cannot retreive grid.");else{e.refreshGrid(),e.loading=!1;var r=e.gm.getGridMetadata();e.metadata.force=r.force,e.metadata.isThemed=r.isThemed,e.metadata.isGiant=r.isGiant,e.metadata.theme=r.theme,e.metadata.provider=r.provider,e.metadata.gridId=r.gridId,e.$nextTick((function(){var t=document.getElementById("grille");e.panzoom=d()(t,{autocenter:!1,bounds:!0})})),e.startedAt=Date.now(),setInterval((function(){e.elapsedRaw=Math.floor((Date.now()-e.startedAt)/1e3)}),200)}})))},mounted:function(){},computed:{elapsed:function(){var e=this.elapsedRaw%60,t=Math.floor(this.elapsedRaw/60);return t=("0"+t.toString(10)).slice(-2),e=("0"+e.toString(10)).slice(-2),"".concat(t,":").concat(e)},getGridStyle:function(){return this.grid?{"grid-template-columns":"repeat(".concat(this.grid.nbColumns,", 50px)"),"grid-template-rows":"repeat(".concat(this.grid.nbLines,", 50px)")}:{}}},methods:{konami:function(){var e=this;if(this.grid){var t=document.getElementsByClassName("cellId");t.forEach((function(t){e.gm.forceReveal(parseInt(t.textContent),"#000000")})),this.grid=this.gm.getGrid()}},refreshGrid:function(){this.grid=this.gm.getGrid(),this.remaining=this.gm.getNbRemainingWords(),this.nbLetters=this.gm.getNbRemainingLetters()},promptGuess:function(e){var t=this;this.guess.prompt=e.def,this.guess.input="",this.guess.position=e.idx,this.guess.show=!0,this.$nextTick((function(){t.$refs.guessInput.focus()}))},tryGuess:function(){this.checkWord(this.player,this.guess.input,this.guess.position,"#7F7F7F"),this.guess.show=!1},checkWord:function(e,t,r,a){t=u.slugify(t).toUpperCase(),console.log("checking ".concat(t," at place ").concat(r));var s={word:t,axis:0,start:r},n=this.gm.checkPlayerWord(s,a,e);return n>0?(this.refreshGrid(),void this.$emit("wordfound",{player:e,points:n,color:a})):(s.axis=1,n=this.gm.checkPlayerWord(s,a,e),n>0?(this.refreshGrid(),void this.$emit("wordfound",{player:e,points:n,color:a})):void 0)},resetZoom:function(){this.panzoom.moveTo(0,0),this.panzoom.zoomAbs(0,0,1)}},destroyed:function(){this.panzoom&&this.panzoom.dispose()}},M=N,P=(r("d812"),Object(b["a"])(M,o,c,!1,null,null,null)),E=P.exports,O=r("3f73"),j=r.n(O),z={name:"App",components:{Grid:E},data:function(){return{ready:!1,scoreboard:{},channel:"",gridKey:0,inputChannel:"",konami:null,config:i.GRID_PROVIDER}},created:function(){var e=this;this.konami=new j.a((function(){e.$refs.grid.konami()})),this.loadScore();var t=new URLSearchParams(window.location.search);this.channel=t.get("channel");var a=r("3cba");this.client=new a.Client({connection:{secure:!0,reconnect:!0},channels:[this.channel]}),this.addListeners(),this.client.connect()},mounted:function(){var e=new URLSearchParams(window.location.search);if(e.has("provider")){var t=parseInt(e.get("force"))||0,r="true"===e.get("themed"),a="true"===e.get("giant"),s=parseInt(e.get("grid"))||null,n=e.get("provider");this.gridKey=this.getGridAddr(t,a,r,s,n)}},computed:{getDomain:function(){return window.location.hostname},getScoreList:function(){var e=this,t=Object.keys(this.scoreboard).map((function(t){return[t,e.scoreboard[t]]}));return t.sort((function(e,t){return t[1].score-e[1].score})),t}},methods:{updateScore:function(e){var t=e.points,r=e.color,a=e.player;a||(a=this.channel),a in this.scoreboard||(this.$set(this.scoreboard,a,null),this.scoreboard[a]=Object.assign({},this.scoreboard[a],{score:0,color:r})),this.scoreboard[a].score+=t,this.saveScore()},resetScore:function(){this.scoreboard={},this.saveScore()},saveScore:function(){localStorage.setItem("score",JSON.stringify(this.scoreboard))},loadScore:function(){try{this.scoreboard=JSON.parse(localStorage.getItem("score"))||{}}catch(e){console.error("Error while loading scoreboard",e),this.scoreboard={}}console.log("scoreboard loaded",this.scoreboard)},addListeners:function(){this.client.on("message",this.handleMessage),this.client.on("connecting",(function(){console.log("Twitch chat connecting...")})),this.client.on("connected",(function(){console.log("Twitch chat connected!")})),this.client.on("disconnected",(function(){console.log("Twitch chat disconnected :/ !")}))},handleMessage:function(e,t,r){console.log(t);var a=t["display-name"]||t.username;if(/[^\w]/g.test(a)&&(a+=" (".concat(t.username,")")),console.log("message received",r,a),t.username===this.channel.toLowerCase()||t.mod||"eskimon"===t.username)if(r=r.trim(),"!reset"===r)localStorage.setItem("score","{}"),this.scoreboard={};else if("!grille "===r.substr(0,8)){var s=r.match(/^!grille\s+([g]?)([t]?)\s*([1-4])\s?([a-z]*)\s?(\d{0,4})$/);if(!s)return;console.log("matcher: ",s);var n="g"===s[1],i="t"===s[2],o=s[3],c=s[4]||"default",l=s[5]||null;this.gridKey=this.getGridAddr(o,n,i,l,c,l)}if(/^[\d ]+\s[a-zA-Z\u00C0-\u024F -]+$/g.test(r)){r=r.trim();var d=r.substr(r.indexOf(" ")+1);this.$refs.grid.checkWord(a,d,parseInt(r),t.color)}},getGridAddr:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"default",n=this.config[s];"custom"===s&&(e=0);var i="",o=0,c=0;e=e.toString(),t&&!r?(o=n["GRIDS"]["giant"]["ranges"][e][0],c=n["GRIDS"]["giant"]["ranges"][e][1],i=n["GRIDS"]["giant"]["root"]):r&&!t?(o=n["GRIDS"]["themed"]["ranges"][0][0],c=n["GRIDS"]["themed"]["ranges"][0][1],i=n["GRIDS"]["themed"]["root"],e="0"):r&&t?(o=n["GRIDS"]["giantthemed"]["ranges"][0][0],c=n["GRIDS"]["giantthemed"]["ranges"][0][1],i=n["GRIDS"]["giantthemed"]["root"],e="0"):(o=n["GRIDS"]["regular"]["ranges"][e][0],c=n["GRIDS"]["regular"]["ranges"][e][1],i=n["GRIDS"]["regular"]["root"]);var l=a;l||(l=Math.floor(o+Math.random()*Math.floor(c-o)).toString()),l="_"+l;var d=n.PROVIDER_ADDR+i+e+l+n.PROVIDER_EXTENSION;return this.updateURL(l.substr(1),t,r,e,s),d},updateURL:function(e,t,r,a,s){var n=window.location.protocol+"//"+window.location.host+window.location.pathname+"?channel=".concat(this.channel);n+="&grid=".concat(e,"&giant=").concat(t,"&themed=").concat(r,"&force=").concat(a,"&provider=").concat(s),window.history.pushState({path:n},"",n)},loadChannel:function(){var e=window.location.protocol+"//"+window.location.host+window.location.pathname+"?channel=".concat(this.inputChannel);window.location=e}}},$=z,B=(r("034f"),Object(b["a"])($,s,n,!1,null,null,null)),W=B.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(e){return e(W)}}).$mount("#app")},"65ab":function(module,exports,__webpack_require__){__webpack_require__("a15b"),__webpack_require__("d3b7");var enums=__webpack_require__("b00c"),Case=__webpack_require__("5541"),_grid=null,_gridInfos=null,_gridMetadata=null,_nbLetters=0,_maxPoints=0,enumCaseParser={InARow:1,Horizontal:2,Vertical:3},enumArrow={Right:0,RightBottom:1,Bottom:2,BottomRight:3};function GridManager(){_gridInfos={provider:"",id:0,level:0,nbWords:0,nbLetters:0},_gridMetadata={force:0,isThemed:!1,isGiant:!1,theme:"",provider:"default",gridId:0}}function getNextCase(e,t,r,a){var s=0;return a&&(s=a.pos,t==enumCaseParser.InARow||t==enumCaseParser.Horizontal?s++:t==enumCaseParser.Vertical&&(s+=e.nbLines)),s>=e.cases.length?null:r!=e.cases[s].type?getNextCase(e,t,r,e.cases[s]):e.cases[s]}function insertDescription(e,t){var r=getNextCase(e,enumCaseParser.InARow,enums.CaseType.Description),a=!1;while(null!==r&&!a)a=r.setDescription(t),r=getNextCase(e,enumCaseParser.InARow,enums.CaseType.Description,r)}function getCaseType(e){return"z"==e?enums.CaseType.Empty:e>="A"&&e<="Z"?enums.CaseType.Letter:enums.CaseType.Description}function onGetGridError(e,t){console.error("\t[ERROR]: Cannot retreive grid..."),console.error("\t[ERROR]: "+t),e(null)}function parseGrid(callback,serverText){var i,j,currentCase=0,type,grid={nbLines:0,nbColumns:0,nbWords:0,cases:[]};for(i in eval(serverText),grid.level=gamedata.force,_gridInfos.level=gamedata.force,_gridInfos.nbLetters=0,grid.nbWords=gamedata.definitions.length,_gridInfos.nbWords=gamedata.definitions.length,grid.nbLines=gamedata.nbcaseshauteur,grid.nbColumns=gamedata.nbcaseslargeur,_gridMetadata.force=gamedata.force,_gridMetadata.isThemed=""!=gamedata.legende,_gridMetadata.isGiant=0,_gridMetadata.theme=gamedata.titre,_gridMetadata.provider=0,_gridMetadata.gridId=0,gamedata.grille)for(j in gamedata.grille[i])type=getCaseType(gamedata.grille[i][j]),type==enums.CaseType.Letter?(grid.cases.push(new Case.LetterCase(currentCase++,gamedata.grille[i][j])),_nbLetters++,_gridInfos.nbLetters++):type==enums.CaseType.Description?grid.cases.push(new Case.DescriptionCase(currentCase++,gamedata.grille[i][j])):grid.cases.push(new Case.EmptyCase(currentCase++));for(i in gamedata.definitions)insertDescription(grid,gamedata.definitions[i].join("\n"));for(i in gamedata.spountzV){var nb=gamedata.spountzV[i][0]+(gamedata.spountzV[i][1]-1)*grid.nbColumns;grid.cases[nb-1].dashed=2}for(i in gamedata.spountzH){var _nb=gamedata.spountzH[i][0]+(gamedata.spountzH[i][1]-1)*grid.nbColumns;grid.cases[_nb-1].dashed=1}placeArrows(grid),_grid=grid}function placeArrows(e){var t,r=e.cases.length;for(t=0;t<r;t++)if(e.cases[t].type==enums.CaseType.Description)switch(e.cases[t].value){case"a":e.cases[t].arrow[0]=enumArrow.Right;break;case"b":e.cases[t].arrow[0]=enumArrow.Bottom;break;case"c":e.cases[t].arrow[0]=enumArrow.RightBottom;break;case"d":e.cases[t].arrow[0]=enumArrow.BottomRight;break;case"e":case"f":case"g":case"h":case"i":e.cases[t].arrow[0]=enumArrow.Right,e.cases[t].arrow[1]=enumArrow.Bottom;break;case"j":case"k":case"l":case"m":case"n":e.cases[t].arrow[0]=enumArrow.RightBottom,e.cases[t].arrow[1]=enumArrow.Bottom;break;case"o":case"p":case"q":case"r":case"s":e.cases[t].arrow[0]=enumArrow.Right,e.cases[t].arrow[1]=enumArrow.BottomRight;break;case"t":case"u":case"v":case"w":case"x":e.cases[t].arrow[0]=enumArrow.RightBottom,e.cases[t].arrow[1]=enumArrow.BottomRight;break;default:console.error("[ERROR][gridManager::placeArrows] Unknow arrow type ["+e.cases[t].value+"] at frame "+t)}}GridManager.prototype.forceReveal=function(e,t){2===_grid.cases[e].type&&_grid.cases[e].available&&(_grid.cases[e].available=!1,_grid.cases[e].color=t,_grid.cases[e].player="")},GridManager.prototype.checkPlayerWord=function(e,t,r){var a,s=0==e.axis?1:_grid.nbColumns,n=e.word.length,i=0,o=e.start;if(e.axis&&o>_grid.nbColumns&&2===_grid.cases[o-s].type)return-1;if(!e.axis&&o%_grid.nbColumns&&2===_grid.cases[o-1].type)return-1;for(a=0;a<n;a++){if(!_grid.cases[o])return-1;if(e.word[a]!=_grid.cases[o].value)return-1;o+=s}if(0===e.axis&&o%_grid.nbColumns&&void 0!=_grid.cases[o]&&2===_grid.cases[o].type)return-1;for(o=e.start,a=0;a<n;a++)1==_grid.cases[o].available&&(_grid.cases[o].available=!1,_grid.cases[o].color=t,_grid.cases[o].player=r,i++,_nbLetters--,_gridInfos.nbLetters--),o+=s;return 0===i?0:(_grid.nbWords--,i)},GridManager.prototype.getGrid=function(){var e;return e=JSON.parse(JSON.stringify(_grid)),e.infos=_gridInfos,e.metadata=_gridMetadata,e},GridManager.prototype.getGridInfos=function(){return _gridInfos},GridManager.prototype.getGridMetadata=function(){return _gridMetadata},GridManager.prototype.getNbRemainingWords=function(){return _grid.nbWords},GridManager.prototype.getNbRemainingLetters=function(){return _gridInfos.nbLetters},GridManager.prototype.getAccomplishmentRate=function(e,t){if(0==_maxPoints)switch(t){case 1:_maxPoints=Math.floor(1.5*_nbLetters);break;case 2:_maxPoints=Math.floor(.9*_nbLetters);break;case 3:_maxPoints=Math.floor(.75*_nbLetters);break;case 4:_maxPoints=Math.floor(.66*_nbLetters);break;default:_maxPoints=_nbLetters;break}return Math.floor(e/_maxPoints*100)},GridManager.prototype.retreiveAndParseGrid=function(e,t){console.info("\n\t[GRIDMANAGER] Try to load "+e),fetch(e).then((function(e){return 200!==e.status&&302!==e.status&&onGetGridError(t,"Wrong statusCode "+e.status),console.info("\t[GRIDMANAGER] Grid downloaded, start parsing...\n"),e.text()})).then((function(e){parseGrid(t,e),console.info("\n\t[GRIDMANAGER] Parsing Done. Now play "+_gridInfos.provider+" "+_gridInfos.id+" - Level "+_gridInfos.level),t(_grid)})).catch((function(e){onGetGridError(t,e)}))},GridManager.prototype.resetGrid=function(e,t){_grid=null,_nbLetters=_maxPoints=0,_gridInfos.id=0,_gridInfos.level=0,_gridInfos.nbWords=0,this.retreiveAndParseGrid(e,t)},module.exports=GridManager},"85ec":function(e,t,r){},"91ce":function(e,t,r){},b00c:function(e,t){var r={WaitingForPlayers:1,OnGame:2},a={OnLoginScreen:1,WaitingInLobby:2,Playing:3,Died:4},s={None:0,Right:1,Bottom:2,RightBottom:3,BottomRight:4},n={All:1,Letter:2,Description:3,Empty:4};t.PlayerState=a,t.ServerState=r,t.ArrowDirections=s,t.CaseType=n},b790:function(e,t,r){},b91a:function(e,t,r){},bbd7:function(e,t,r){"use strict";var a=r("b91a"),s=r.n(a);s.a},d812:function(e,t,r){"use strict";var a=r("b790"),s=r.n(a);s.a},dd71:function(e,t,r){"use strict";var a=r("0300"),s=r.n(a);s.a}});
//# sourceMappingURL=app.9ca36082.js.map